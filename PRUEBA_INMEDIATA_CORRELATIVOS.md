# ğŸ§ª PRUEBA INMEDIATA: CREAR TU PRIMER CAJERO CON CORRELATIVO

---

## ğŸ¯ OBJETIVO

Crear tu primer cajero y ver cÃ³mo funcionan los correlativos EN VIVO.

---

## â±ï¸ TIEMPO ESTIMADO: 3 MINUTOS

---

## ğŸ“‹ PASO A PASO (COPIA Y PEGA)

### **1ï¸âƒ£ ENTRA AL SUPERADMIN**

1. Ve a: https://rubennaldos.github.io/parent-portal-connect/
2. Inicia sesiÃ³n como SuperAdmin:
   - Email: `superadmin@limacafe28.com`
   - Tipo: **Personal del Sistema (Admin/POS/Kitchen)**

---

### **2ï¸âƒ£ VE A "PERFILES POR SEDE"**

Haz clic en la pestaÃ±a: **"Perfiles por Sede"**

VerÃ¡s las 7 sedes:
- Nordic
- Saint George Villa
- Saint George Miraflores
- Little Saint George
- Jean LeBouch
- Maristas Champagnat 1
- Maristas Champagnat 2

---

### **3ï¸âƒ£ ELIGE UNA SEDE (EJ: JEAN LEBOUCH)**

VerÃ¡s algo asÃ­:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Jean LeBouch                          â”‚
â”‚  CÃ³digo: JLB | Prefijo base: JLB       â”‚
â”‚  âœ¨ Siguiente correlativo POS: JLB1   â”‚
â”‚  [Agregar Perfil]              0/3     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **4ï¸âƒ£ HAZ CLIC EN "AGREGAR PERFIL"**

Se abrirÃ¡ un formulario modal.

---

### **5ï¸âƒ£ LLENA EL FORMULARIO**

```
Tipo de Perfil: Punto de Venta (POS)
Nombre Completo: MarÃ­a LÃ³pez
Email: maria.jlb@limacafe28.com
ContraseÃ±a: Test123456
```

---

### **6ï¸âƒ£ PRESIONA "CREAR USUARIO"**

VerÃ¡s un mensaje de Ã©xito:

```
âœ… Usuario Creado
Cajero maria.jlb@limacafe28.com creado exitosamente con prefijo JLB1
```

---

### **7ï¸âƒ£ Â¡AHORA SÃ VERÃS EL CAJERO!**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Jean LeBouch                          â”‚
â”‚  CÃ³digo: JLB | Prefijo base: JLB       â”‚
â”‚  âœ¨ Siguiente correlativo POS: JLB2   â”‚ â† CAMBIÃ“ A JLB2
â”‚  [Agregar Perfil]              1/3     â”‚ â† AHORA 1/3
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¦ Puntos de Venta (POS)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ maria.jlb@limacafe28.com        â”‚  â”‚
â”‚  â”‚ [JLB1] âœï¸                       â”‚  â”‚ â† BOTÃ“N DE EDITAR
â”‚  â”‚                             âœ…  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **8ï¸âƒ£ PRUEBA EDITAR EL CORRELATIVO**

1. Haz clic en el **lÃ¡piz âœï¸**
2. El badge `JLB1` se convertirÃ¡ en un campo de texto
3. CÃ¡mbialo a `JEAN1` (o lo que quieras)
4. Presiona **Enter**
5. VerÃ¡s confirmaciÃ³n:

```
âœ… Prefijo Actualizado
Cambiado de JLB1 a JEAN1
```

6. Ahora MarÃ­a generarÃ¡ tickets: `JEAN1-001`, `JEAN1-002`, etc.

---

### **9ï¸âƒ£ CREA UN SEGUNDO CAJERO (OPCIONAL)**

Repite el proceso con:

```
Tipo de Perfil: Punto de Venta (POS)
Nombre Completo: Pedro GÃ³mez
Email: pedro.jlb@limacafe28.com
ContraseÃ±a: Test123456
```

Ahora verÃ¡s:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¦ Puntos de Venta (POS)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ maria.jlb@limacafe28.com        â”‚  â”‚
â”‚  â”‚ [JEAN1] âœï¸                      â”‚  â”‚
â”‚  â”‚                             âœ…  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ pedro.jlb@limacafe28.com        â”‚  â”‚
â”‚  â”‚ [JLB2] âœï¸                       â”‚  â”‚ â† NUEVO CAJERO
â”‚  â”‚                             âœ…  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” VERIFICAR EN LA BASE DE DATOS

Ve a Supabase â†’ SQL Editor y ejecuta:

```sql
-- Ver cajeros creados con sus correlativos
SELECT 
  p.email,
  s.name AS sede,
  s.code AS codigo_sede,
  p.pos_number AS numero_cajero,
  p.ticket_prefix AS prefijo_tickets,
  ts.current_number AS tickets_generados
FROM profiles p
JOIN schools s ON s.id = p.school_id
LEFT JOIN ticket_sequences ts ON ts.pos_user_id = p.id
WHERE p.role = 'pos'
ORDER BY s.name, p.pos_number;
```

**Resultado esperado:**

| email | sede | codigo_sede | numero_cajero | prefijo_tickets | tickets_generados |
|-------|------|-------------|---------------|-----------------|-------------------|
| maria.jlb@limacafe28.com | Jean LeBouch | JLB | 1 | JEAN1 | 0 |
| pedro.jlb@limacafe28.com | Jean LeBouch | JLB | 2 | JLB2 | 0 |

---

## ğŸ« PRÃ“XIMO PASO: GENERAR TICKETS

Una vez que tengas cajeros creados, cuando uses el mÃ³dulo POS:

```javascript
// En el mÃ³dulo POS, al hacer una venta:
const { data: ticketCode } = await supabase
  .rpc('get_next_ticket_number', { p_user_id: cajeroId });

// Resultado: 'JEAN1-001'

// Se registra la transacciÃ³n con ese cÃ³digo:
await supabase.from('transactions').insert({
  student_id: 'estudiante-id',
  type: 'purchase',
  amount: 8.50,
  ticket_code: 'JEAN1-001',
  pos_user_id: cajeroId
});

// PrÃ³ximo ticket de MarÃ­a: 'JEAN1-002'
// PrÃ³ximo ticket de Pedro: 'JLB2-001'
```

---

## âœ… CHECKLIST DE PRUEBA

- [ ] EntrÃ© al SuperAdmin
- [ ] Fui a "Perfiles por Sede"
- [ ] Vi el mensaje "âœ¨ Siguiente correlativo POS: JLB1"
- [ ] CreÃ© un cajero (MarÃ­a)
- [ ] Vi el cajero con su prefijo `[JLB1] âœï¸`
- [ ] Hice clic en el lÃ¡piz y cambiÃ© el prefijo
- [ ] Vi la confirmaciÃ³n de actualizaciÃ³n
- [ ] CreÃ© un segundo cajero (Pedro) con prefijo `JLB2`
- [ ] VerifiquÃ© en Supabase que los datos estÃ¡n correctos

---

## ğŸš¨ SOLUCIÃ“N DE PROBLEMAS

### **No veo el botÃ³n âœï¸**
â¡ï¸ **Causa:** AÃºn no has creado cajeros.  
â¡ï¸ **SoluciÃ³n:** Crea al menos un cajero con "Agregar Perfil".

### **Error al crear cajero**
â¡ï¸ **Causa:** Falta ejecutar el SQL de Phase 1.  
â¡ï¸ **SoluciÃ³n:** Ejecuta `FASE1_BASE_DATOS_PERFILES.sql` en Supabase.

### **No aparece el correlativo sugerido**
â¡ï¸ **Causa:** Falta la tabla `school_prefixes`.  
â¡ï¸ **SoluciÃ³n:** Verifica que ejecutaste todo el SQL de Phase 1.

---

## ğŸ“ SI TIENES DUDAS

Dime:
1. Â¿En quÃ© paso estÃ¡s?
2. Â¿QuÃ© mensaje de error ves?
3. Â¿Puedes compartir una captura de pantalla?

---

**Â¡EMPIEZA LA PRUEBA AHORA!** ğŸš€

